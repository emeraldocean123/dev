# Windows PATH Management Scripts

PowerShell scripts for analyzing, cleaning, and managing the Windows PATH environment variable.

**Created:** November 11, 2025
**Location:** `~/Documents/dev/shell-management/path-management/`

## Overview

These scripts help maintain a clean Windows PATH by identifying and removing:
- Duplicate entries
- Orphaned paths (folders that don't exist)
- Paths from uninstalled programs
- Directory name typos

## Scripts

### 1. check-path.ps1
**Purpose:** Analyze Windows PATH for issues and generate cleaned version

**What it does:**
- Lists all PATH entries with numbering
- Identifies duplicate entries
- Finds orphaned paths (non-existent folders)
- Generates cleaned PATH automatically
- Saves cleaned PATH to `cleaned-path.txt`

**Usage:**
```powershell
cd ~/Documents/dev/shell-management/path-management
./check-path.ps1
```

**Output:**
- Displays all PATH entries
- Shows duplicates found (with count)
- Shows orphaned paths (with count)
- Shows cleaned PATH statistics
- Saves cleaned PATH to `cleaned-path.txt`

### 2. apply-cleaned-path.ps1
**Purpose:** Apply cleaned PATH with user confirmation (interactive)

**What it does:**
- Backs up current USER PATH (with timestamp)
- Loads cleaned PATH from `cleaned-path.txt`
- Shows before/after comparison
- Prompts for confirmation ("yes/no")
- Applies cleaned PATH to USER environment variable
- Verifies the change

**Usage:**
```powershell
cd ~/Documents/dev/shell-management/path-management
./apply-cleaned-path.ps1
```

**Safety features:**
- Requires explicit "yes" confirmation
- Creates automatic backup before changes
- Only modifies USER PATH (not SYSTEM PATH)
- Provides rollback instructions

### 3. apply-cleaned-path-auto.ps1
**Purpose:** Apply cleaned PATH automatically (no confirmation)

**What it does:**
- Same as `apply-cleaned-path.ps1` but without interactive prompt
- Useful for automated scripts or when confirmation already obtained

**Usage:**
```powershell
cd ~/Documents/dev/shell-management/path-management
./apply-cleaned-path-auto.ps1
```

**WARNING:** This script applies changes immediately without asking. Only use when you're certain you want to proceed.

## Files

### Script Files
- **check-path.ps1** - PATH analysis and cleaning script
- **apply-cleaned-path.ps1** - Interactive PATH application (with confirmation)
- **apply-cleaned-path-auto.ps1** - Automatic PATH application (no confirmation)

### Data Files
- **cleaned-path.txt** - Latest cleaned PATH (generated by check-path.ps1)
- **path-backup-YYYY-MM-DD-HHmmss.txt** - Automatic backups (timestamped)
- **path-cleanup-report-YYYY-MM-DD.md** - Detailed cleanup reports

## Typical Workflow

### First-Time PATH Cleanup

1. **Analyze current PATH:**
   ```powershell
   cd ~/Documents/dev/shell-management/path-management
   ./check-path.ps1
   ```

2. **Review the output:**
   - Check which duplicates will be removed
   - Check which orphaned paths will be removed
   - Review the cleaned PATH entry count

3. **Apply cleaned PATH:**
   ```powershell
   ./apply-cleaned-path.ps1
   ```
   - Type "yes" when prompted
   - Backup is created automatically

4. **Verify changes:**
   - Close and reopen your terminal
   - Test critical tools (git, exiftool, python, node, etc.)

### Periodic Maintenance

Run `check-path.ps1` every 6-12 months to detect new duplicates from software installations.

## Important Notes

### USER PATH vs SYSTEM PATH

These scripts only modify **USER PATH** (not SYSTEM PATH):
- **USER PATH:** Per-user environment variable (doesn't require admin)
- **SYSTEM PATH:** System-wide environment variable (requires admin)
- **Combined PATH:** `$env:Path` shows both SYSTEM + USER combined

When you run `echo $env:Path`, you'll see the combined path which may show apparent duplicates if entries exist in both SYSTEM and USER paths. This is normal behavior.

### Changes Take Effect in New Windows

- PATH changes only apply to **new** terminal/application windows
- Current open windows still have the old PATH cached
- Close and reopen terminals to see the updated PATH

### Backup Safety

Every time you apply changes, a timestamped backup is created:
- Format: `path-backup-YYYY-MM-DD-HHmmss.txt`
- Contains your original USER PATH before changes
- Can be used to rollback if needed

### Rollback Instructions

To restore a previous PATH from backup:

```powershell
[Environment]::SetEnvironmentVariable('Path', (Get-Content 'C:\Users\josep\Documents\dev\shell-management\path-management\path-backup-YYYY-MM-DD-HHmmss.txt'), 'User')
```

Replace the timestamp with your specific backup file.

## Example: November 11, 2025 Cleanup

### Issues Found
- 41 entries in USER PATH (before cleanup)
- 29 duplicate entries
- 7 orphaned paths (non-existent folders)
- ExifTool path standardized: `Program-Portable` → `Programs-Portable`
- Old paths from uninstalled programs (MPV.NET, OneFolder)

### Results
- Reduced to 39 entries (removed 36 total issues)
- Fixed ExifTool directory typo
- Removed all orphaned paths
- Removed all duplicate entries
- Backup: `path-backup-2025-11-11-222945.txt`

### Verification
All critical tools tested and working:
- Git: v2.51.2.windows.1 ✓
- ExifTool: 13.41 ✓
- Python: 3.13.9 ✓
- Node.js: v25.1.0 ✓

See `path-cleanup-report-2025-11-11.md` for full details.

## Recommendations

### Monitor PATH Bloat
Programs often add themselves to PATH during installation. Common culprits:
- Development tools (Git, Node.js, Python)
- Package managers (npm, pip, winget)
- Utility software (ExifTool, ImageMagick, etc.)

### Keep Multiple Tool Versions
If you have multiple versions of a tool (like ExifTool portable + installed):
- Keep the preferred version listed **first** in PATH
- First match in PATH takes precedence
- Both can coexist safely

### Test After Cleanup
After applying cleaned PATH, verify critical tools:
```bash
git --version
exiftool -ver
python --version
node --version
npm --version
```

## See Also

- **Shell configs:** `~/Documents/dev/shell-management/configs/`
- **PowerShell profile:** `~/Documents/PowerShell/Microsoft.PowerShell_profile.ps1`
- **PowerShell scripts:** `~/Documents/PowerShell/Scripts/`
